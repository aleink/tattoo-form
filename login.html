<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sign in â€“ Club Tattoo Admin</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <style>
    :root{
      --bg:#111;--card:#222;--border:#444;--txt:#fff;--accent:#28a745;
    }
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Helvetica Neue',Arial,sans-serif}
    body{background:var(--bg);color:var(--txt);display:flex;align-items:center;justify-content:center;height:100vh;padding:16px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:6px;padding:26px;max-width:360px;width:100%}
    h1{margin-bottom:18px;text-align:center}
    label{display:block;font-weight:700;margin:10px 0 4px}
    input{width:100%;padding:8px;background:#000;color:#fff;border:1px solid var(--border);border-radius:4px}
    button{width:100%;margin-top:18px;padding:10px;background:var(--accent);border:none;border-radius:4px;cursor:pointer;color:#fff;font-weight:700}
    .msg{margin-top:12px;color:#ff6b6b;text-align:center;font-size:.9em}
  </style>
</head>
<body>
  <div class="card">
    <h1>Admin Login</h1>
    <label>Email</label><input id="email" type="email">
    <label>Password</label><input id="pass" type="password">
    <button id="login-btn">Log in</button>
    <div id="msg" class="msg"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@1.35.7/dist/umd/supabase.min.js"></script>
  <script>
    const supabase=window.supabase.createClient(
      'https://shlvjhipxnslrncczopn.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNobHZqaGlweG5zbHJuY2N6b3BuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY2NDgzNjIsImV4cCI6MjA2MjIyNDM2Mn0.oPrYFyW0IsDnNsDpQ9LI0cOm6Y7OIJbjebp2Zjvv_qQ'
    );
    const email=document.getElementById('email');
    const pass=document.getElementById('pass');
    const msg=document.getElementById('msg');
    document.getElementById('login-btn').onclick=async()=>{
      msg.textContent='';
      if(!email.value||!pass.value){msg.textContent='Email & password required.';return;}
      const {data,error}=await supabase
        .from('users')
        .select('*')
        .eq('email',email.value.trim());
      if(error||!data.length){msg.textContent='Invalid credentials.';return;}
      const user=data[0];
      if(user.password_hash!==pass.value.trim()){msg.textContent='Invalid credentials.';return;}
      /* store lightweight session  */
      localStorage.setItem('userRole',user.role);
      localStorage.setItem('userLocation',user.location_id||'');
      localStorage.setItem('userId',user.id);
      location.href='manage_artists.html';
    };
  </script>
</body>
</html>
